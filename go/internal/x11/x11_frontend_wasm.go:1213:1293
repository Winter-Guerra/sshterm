func (w *wasmX11Frontend) applyGC(ctx js.Value, colormap xID, gcID xID, draw func(js.Value)) {
	gc, ok := w.gcs[gcID]
	if !ok {
		return
	}

	ctx.Call("save")
	defer ctx.Call("restore")

	w.applyGCState(ctx, colormap, gc)

	var nativeOp string
	switch gc.Function {
	case FunctionClear:
		nativeOp = "destination-out"
	case FunctionAnd:
		nativeOp = "source-in"
	case FunctionAndReverse:
		nativeOp = "source-out"
	case FunctionCopy:
		nativeOp = "source-over"
	case FunctionAndInverted:
		nativeOp = "destination-in"
	case FunctionNoOp:
		return
	case FunctionXor:
		nativeOp = "xor"
	case FunctionOr:
		nativeOp = "source-over" // Closest approximation
	case FunctionNor:
		nativeOp = "source-over" // No equivalent
	case FunctionEquiv:
		nativeOp = "source-over" // No equivalent
	case FunctionInvert:
		nativeOp = "difference"
	case FunctionOrReverse:
		nativeOp = "destination-over"
	case FunctionCopyInverted:
		nativeOp = "source-over" // No equivalent
	case FunctionOrInverted:
		nativeOp = "destination-atop"
	case FunctionNand:
		nativeOp = "source-over" // No equivalent
	case FunctionSet:
		nativeOp = "source-over" // The color is already set, so just copy it.
	default:
		nativeOp = "source-over"
	}
	ctx.Set("globalCompositeOperation", nativeOp)

	draw(ctx)
}
